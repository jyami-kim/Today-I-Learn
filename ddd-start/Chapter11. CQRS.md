# Chapter11. CQRS

### 단일 모델의 단점

JPA 한번의 select 쿼리로 조회 화면에 필요한 데이터를 읽어올 수 없어 조회 속도에 문제가 생길 숭 ㅣㅆ다.



### CQRS

- 상태를 변경하는 기능

  애그리거트의 상태를 변경한다

- 사용자 입장에서 상태 정보를 조회하는 기능

  두개 이상의 애그리거트에서 데이터를 조회할 수 있음 (상태를 변경하는 범위와 상태를 조회하는 범위가 정확하게 일치하지 않음)

Command Query Responsibility Segregation

복잡한 도메인에 적합하다 : 단일 모델로 처리하게 되면 조회기능의 로딩 속도를 위해 모델 구현이 필요 이상으로 복잡해지는 무제가 발생.

명령 모델과 조회 모델이 서로 다른 DB를 사용할 수도 있다

- 명령 모델은 트랜잭션을 지원해주는 RDBMS를 사용하고,
- 조회 모델은 조회 성능이 좋은 메모리 기반 NoSQL을 사용할 수 있을 것

RDB와 NoSQL 간의 동기화가 늦어 문제가 될 수 있지 않는가? 감안하고 갈 수 있다. 아주 실시간 적 변동사항이 필요한게 아니라면 충분히 도입해도 괜찮다 (통계 데이터는 1시간 단위로 최근 데이터를 반영해도 괜찮음)



### CQRS 장단점

장점

- 하나의 명령 모델을 구현할 때 도메인 자체에 집중할 수 있다.
- 조회 성능을 향상시키는데 유리하다.

단점

- 구현해야 할 코드가 더 많다.
- 더 많은 구현 기술이 필요하다. 명령, 조회 모델을 다른 구현 기술을 사용해서 구현하기도 하고 경우에 따라 다른 저장소를 사용하기도 한다. 데이터 동기화를 위해 메시징 시스템을 도입해야할 수도 있다.

