# Chapter11. 일반화 처리

일반화는 주로 상속 계층 구조나 상속 계층의 위나 아래로, 즉 상위 클래스나 하위 클래스로 메서드를 옮기는 기법이다.

### 필드 상향 (Pull Up Field)

두 하위 클래스에 같은 필드가 들어 있을 땐 필드는 상위클래스로 옮기자

- 중복된 필드가 서로 비슷한 방식으로 사용된다면 그 필드를 일반화하면 된다.
- 데이터 선언의 중복이 없어진다
- 그 필드를 사용하는 기능이 하위클래스에서 상위클래스로 옮겨진다



### 메서드 상향 (Pull Up Method)

기능이 같은 메서드가 여러 하위클래스에 들어 있을 땐 그 메서드를 상위 클래스로 옮기자

- 메서드 내용이 마치 복사해서 붙여 넣은 것처럼 서로 같을 때 사용한다.
- 다른 리팩토링 단계를 마친 후 적용하는 것이 일반적이다.
- 두 메서드가 똑같진 않고 비슷한 부분이 있다면 템플릿 메서드 형성을 실시하자.



### 생성자 내용 상향 (Pull Up )

하위 클래스마다 거의 비슷한 내용의 생성자가 있을 땐 상위클래스에 생성자를 작성하고, 그 생성자를 하위 클래스의 메서드에서 호출하자

- 리팩토링이 복잡해질 땐 이 기법대신 생성자를 팩토리 메서드로 전환을 적용해야할 수도 있다.



### 메서드 하향 (Push Down Method)

상위 클래스에 있는 기능을 일부 하위 클래스만 사용할 땐 그 기능을 관련된 하위 클래스 안으로 옮기자.



### 필드 하향 (Push Down Field)

일부 하위 클래스만이 사용하는 필드가 있을 땐



### 하위클래스 추출 (Extract Subclass)

일부 인스턴스에만 사용되는 기능이 든 클래스가 있을 땐 그 기능 부분을 전담하는 하위클래스를 작성하자

- 클래스의 기능을 그 클래스의 일부 인스턴스만 사용할 때 적용한다.
- 클래스 추출을 사용할 수도 있는데, 이들사이의 차이점은 위임이냐 상속이냐의 차이다.
- 객체가 생성된 후에는 객체의 클래스 기반 기능을 수정할 수 없다
- 하위 클래스를 사용해서 한가지 변형만을 표현할 수도 있어 단점이 있다.



### 상위 클래스 추출 (Extract Superclass)

기능이 비슷한 두 클래스가 있을 땐 상위클래스를 작성하고 공통된 기능들을 그 상위클래스로 옮기자

- 상위 클래스 추출을 사용할 수 없으면 클래스 추출을 적용하면 된다. 이 둘은 기본적으로 상속이냐 위임이냐의 차이다.



### 인터페이스 추출 (Extract Interface)

클래스 인터페이스의 같은 부분을 여러 클라이언트가 사용하거나, 두 클래스에 인터페이스의 일부분이 공통으로 들어 있을 땐 공통 부분을 인터페이스로 빼내자

- 인터페이스는 공통된 코드를 빼내는 것이 아닌 공통된 인터페이스만 빼내는 기법이다.
- 클래스가 서버에서 하는 작업을 기술해야할 때도 인터페이스를 사용하면 좋다.



### 계층 병합 (Collapse Hierarchy)

상위 클래스와 하위클래스가 거의 다르지 않을 땐 둘을 합치자

- 상속의 고유한 장점에 빠져들어 상속을 과용한 나머지 클래스 관계가 복잡해지는 경우가 많다. 하위 클래스가 쓸모가 없어지면 하나의 클래스로 합쳐야한다.



### 템플릿 메서드 형성 (Form Template Method)

하위 클래스 안의 두 메서드가 거의 비슷한 단계들을 같은 순서로 수행할 땐 그 단계들을 시그너처가 같은 두 개의 메서드로 만들어서 두 원본 메서드를 같게 만든 후, 두 메서드를 상위클래스로 옮기자.

- 중복된 부분은 가능한 없애고 차이가 있는 필수 부분만 그대로 두어야한다.
- 두 메서드가 똑같지는 않지만 거의 비슷한 단계를 같은 순서로 수행하는 경우



### 상속을 위임으로 전환 (Replace Inheritance with Delegation)

하위클래스가 상위클래스 인터페이스의 일부만 사용할때나 데이터를 상속받지 않게 해야 할 땐 상위클래스에 필드를 작성하고 모든 메서드가 그 상위클래스에 위임하게 수정한 후 하위클래스를 없애자

- 위임을 사용하면 위임받은 클래스의 일부만 사용하려는 의도가 더욱 확실해진다.
- 인터페이스의 어느 부분을 사용하고 어느 부분을 무시할지를 개발자가 제어할 수 있다.



### 위임을 상속으로 전환 (Replace Delegation with Inheritance)

위임을 이용 중인데 인터페이스 전반에 간단한 위임으로 도배하게 될 땐 위임 클래스를 대리 객체의 하위 클래스로 만들자

- 위임하려는 클래스의 모든 메서드를 사용하는 게 아닐 경우 위임을 상속으로 전환을 적용해서는 안된다.
- 대리 객체를 둘 이상의 객체가 사용하고 변경가능할 때는 바꿀 수 없다. (이럴 땐 데이터를 더 이상 공유할 일이 없어서)







